
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Functional connectivity &#8212; Méthodes en neurosciences cognitives</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'connectivite';</script>
    <link rel="icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="IRM de diffusion" href="irm_diffusion.html" />
    <link rel="prev" title="IRM fonctionnelle" href="irm_fonctionnelle.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Méthodes en neurosciences cognitives - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Méthodes en neurosciences cognitives - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cartes_cerebrales.html">Cartes cérébrales</a></li>
<li class="toctree-l1"><a class="reference internal" href="irm.html">Imagerie par résonance magnétique</a></li>
<li class="toctree-l1"><a class="reference internal" href="morphometrie.html">Analyses morphométriques</a></li>
<li class="toctree-l1"><a class="reference internal" href="irm_fonctionnelle.html">IRM fonctionnelle</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Functional connectivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="irm_diffusion.html">IRM de diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="imagerie_optique.html">Imagerie optique</a></li>
<li class="toctree-l1"><a class="reference internal" href="tep.html">Tomographie par émission de positrons</a></li>
<li class="toctree-l1"><a class="reference internal" href="cartes_statistiques.html">Cartes statistiques</a></li>
<li class="toctree-l1"><a class="reference internal" href="reproductibilite.html">Reproductibilité et controverses</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/psy3018/notes_cours_psy3018" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/psy3018/notes_cours_psy3018/edit/main/methodes_neurocog/connectivite.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/psy3018/notes_cours_psy3018/issues/new?title=Issue%20on%20page%20%2Fconnectivite.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/connectivite.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Functional connectivity</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Functional connectivity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-connectivity-map">Functional connectivity map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#default-mode-network">Default mode network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deactivations">Deactivations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dan-and-negative-correlations">DAN and negative correlations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#connectomes-et-networks">Connectomes et networks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brain-networks-atlases">Brain networks atlases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus">Bonus</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="functional-connectivity">
<span id="connectivite-chapitre"></span><h1>Functional connectivity<a class="headerlink" href="#functional-connectivity" title="Link to this heading">#</a></h1>
<table>
  <tr>
    <td align="center">
      <a href="https://github.com/sangfrois">
        <img src="https://avatars.githubusercontent.com/u/38385719?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>François Lespinasse</b></sub>
      </a>
      <br />
        <a title="Contenu">🤔</a>
        <a title="Révision du texte">👀</a>
    </td>
    <td align="center">
      <a href="https://github.com/pbellec">
        <img src="https://avatars.githubusercontent.com/u/1670887?v=4?s=100" width="100px;" alt=""/>
        <br /><sub><b>Pierre bellec</b></sub>
      </a>
      <br />
        <a title="Contenu">🤔</a>
        <a title="Code">💻</a>
        <a title="Exercices">⚠️</a>
        <a title="Révision du texte">👀</a>
    </td>
  </tr>
</table>
<section id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Link to this heading">#</a></h2>
<p>In the <a class="reference internal" href="irm_fonctionnelle.html"><span class="doc std std-doc">activation maps</span></a> chapter, we have seen that this type of analysis emphasizes on the notion of functional segregation, which refers to the extent to which certain brain regions are specifically engaged by a certain category of cognitive processes. However, it is well known that cognitive processes also require a certain degree of <strong>functional integration</strong>, where different regions of the brain interact together to perform a task. This notion of integration leads to conceiving of the brain as a network, or a graph, that describes the <strong>functional connectivity</strong> between brain regions. This chapter introduces basic concepts used to study brain connectivity using fMRI.</p>
<figure class="align-default" id="brain-graph-fig">
<a class="reference internal image-reference" href="_images/brain-graph-fig.png"><img alt="_images/brain-graph-fig.png" src="_images/brain-graph-fig.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 55 </span><span class="caption-text">Average functional connectivity graph from the ADHD-200 dataset. Each node of the graph represents a brain region, and the edges represent the average functional connectivity over the ADHD-200 dataset <span id="id1">[<a class="reference internal" href="references.html#id4" title="HD-200 Consortium. The ADHD-200 consortium: a model to advance the translational potential of neuroimaging in clinical neuroscience. Front. Syst. Neurosci., 6:62, September 2012. doi:https://dx.doi.org/10.3389%2Ffnsys.2012.00062.">3</a>]</span>, after thresholding. The color scale and the size of the nodes represent the number of connections (degree) associated with each node. The graph is generated using the <a class="reference external" href="https://gephi.org/">gephi</a> library. The figure is taken from <span id="id2">[<a class="reference internal" href="references.html#id5" title="Pierre Bellec, Carlton Chu, François Chouinard-Decorte, Yassine Benhajali, Daniel S. Margulies, and R. Cameron Craddock. The neuro bureau adhd-200 preprocessed repository. NeuroImage, 144:275-286, 2017. Data Sharing Part II. doi:https://doi.org/10.1016/j.neuroimage.2016.06.034.">4</a>]</span>, under the CC-BY license.</span><a class="headerlink" href="#brain-graph-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The specific objectives of this chapter are:</p>
<ul class="simple">
<li><p>Understand the definition of <strong>functional connectivity</strong>.</p></li>
<li><p>Understand the notion of <strong>connectivity map</strong>.</p></li>
<li><p>Understand the notion of <strong>functional network</strong>.</p></li>
<li><p>Be familiar with the  <strong>main resting-state networks</strong>.</p></li>
</ul>
</section>
<section id="id3">
<h2>Functional connectivity<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importer les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span><span class="p">,</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiLabelsMasker</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span> <span class="c1"># Fetch data using nilearn</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Initialise la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="c1"># Importe les données</span>
<span class="n">basc</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_basc_multiscale_2015</span><span class="p">()</span> <span class="c1"># the BASC multiscale atlas</span>
<span class="n">adhd</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_adhd</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>          <span class="c1"># ADHD200 preprocessed data (Athena pipeline)\</span>

<span class="c1"># Paramètres du pré-traitement</span>
<span class="n">num_data</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">high_pass</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">high_variance_confounds</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">time_samp</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Extrait le signal par parcelle pour un atlas fonctionnel (BASC)</span>
<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiLabelsMasker</span><span class="p">(</span>
                                      <span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">],</span>
                                      <span class="n">resampling_target</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                      <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">memory</span><span class="o">=</span><span class="s1">&#39;nilearn_cache&#39;</span><span class="p">,</span>
                                      <span class="n">memory_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # parcels))&quot;</span><span class="p">)</span>

<span class="c1"># Fonction pour montrer une parcelle</span>
<span class="k">def</span> <span class="nf">_montre_roi</span><span class="p">(</span><span class="n">num_parcel</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">ax_plot</span><span class="p">,</span> <span class="n">cmap</span><span class="p">):</span>
    <span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;img == </span><span class="si">{</span><span class="n">num_parcel</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">]),</span>
              <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
              <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
              <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>

<span class="c1"># Montre les parcelles</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">num_parcel1</span> <span class="o">=</span> <span class="mi">73</span>
<span class="n">_montre_roi</span><span class="p">(</span><span class="n">num_parcel1</span><span class="p">,</span> <span class="s2">&quot;M1 droit&quot;</span><span class="p">,</span> <span class="n">ax_plot</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;winter&#39;</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">num_parcel2</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">_montre_roi</span><span class="p">(</span><span class="n">num_parcel2</span><span class="p">,</span> <span class="s2">&quot;M1 gauche&quot;</span><span class="p">,</span> <span class="n">ax_plot</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;autumn&#39;</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">num_parcel3</span> <span class="o">=</span> <span class="mi">17</span>
<span class="n">_montre_roi</span><span class="p">(</span><span class="n">num_parcel3</span><span class="p">,</span> <span class="s2">&quot;Cingulaire Posterieur&quot;</span><span class="p">,</span> <span class="n">ax_plot</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;summer&#39;</span><span class="p">)</span>

<span class="c1"># Extrait les séries temporelles</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">tseries1</span> <span class="o">=</span> <span class="n">tseries</span><span class="p">[</span><span class="n">time_samp</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">num_parcel1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># -1 car python utilise le zero-index</span>
<span class="n">tseries2</span> <span class="o">=</span> <span class="n">tseries</span><span class="p">[</span><span class="n">time_samp</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">num_parcel2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># -1 car python utilise le zero-index</span>
<span class="n">tseries3</span> <span class="o">=</span> <span class="n">tseries</span><span class="p">[</span><span class="n">time_samp</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">num_parcel3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># -1 car python utilise le zero-index</span>

<span class="c1"># Fonction pour montrer les séries temporelles</span>
<span class="k">def</span> <span class="nf">_montre_serie</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">ax_plot</span><span class="p">,</span> <span class="n">color1</span><span class="p">,</span> <span class="n">color2</span><span class="p">):</span>
    <span class="n">ax_plot</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;40&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">time_samp</span><span class="p">],</span> <span class="n">y1</span><span class="p">,</span> <span class="n">color1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">time_samp</span><span class="p">],</span> <span class="n">y2</span><span class="p">,</span> <span class="n">color2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temps (s.)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;BOLD (u.a.)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Séries temporelles (r=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="n">y2</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1"># plot les séries temporelles</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">_montre_serie</span><span class="p">(</span><span class="n">tseries1</span><span class="p">,</span> <span class="n">tseries2</span><span class="p">,</span> <span class="n">ax_plot</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">_montre_serie</span><span class="p">(</span><span class="n">tseries1</span><span class="p">,</span> <span class="n">tseries3</span><span class="p">,</span> <span class="n">ax_plot</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">_montre_serie</span><span class="p">(</span><span class="n">tseries2</span><span class="p">,</span> <span class="n">tseries3</span><span class="p">,</span> <span class="n">ax_plot</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;connectivity-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="connectivity-fig" style="width: 600px">
<img alt="_images/08a67b10783f26257096eb329a07980b07482bbe0fcd2cd166e70024a83d32b4.png" src="_images/08a67b10783f26257096eb329a07980b07482bbe0fcd2cd166e70024a83d32b4.png" />
<figcaption>
<p><span class="caption-number">Fig. 56 </span><span class="caption-text">Functional connectivity between brain regions, for a participant from the ADHD-200 dataset <span id="id4">[<a class="reference internal" href="references.html#id4" title="HD-200 Consortium. The ADHD-200 consortium: a model to advance the translational potential of neuroimaging in clinical neuroscience. Front. Syst. Neurosci., 6:62, September 2012. doi:https://dx.doi.org/10.3389%2Ffnsys.2012.00062.">3</a>]</span>. For each region (on the left), the average activity is extracted. For each pair of regions, connectivity is measured by the <code class="docutils literal notranslate"><span class="pre">r</span></code> correlation between the associated time series (on the right). The colors of the regions and time series correspond to each other. This figure is generated by python code using the <a class="reference external" href="https://nilearn.github.io/">nilearn</a> library (click on + to see the code), and is distributed under the CC-BY license.</span><a class="headerlink" href="#connectivity-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><em><strong>Functional connectivity</strong></em> is a relatively generic term used to describe a measure of the spatial dependencies of brain activity <span id="id5">[<a class="reference internal" href="references.html#id22" title="Michael D. Fox and Marcus E. Raichle. Spontaneous fluctuations in brain activity observed with functional magnetic resonance imaging. Nature Reviews Neuroscience, 8(9):700–711, September 2007. URL: https://doi.org/10.1038/nrn2201, doi:10.1038/nrn2201.">20</a>]</span>. The simplest technique for conducting this type of analysis is to extract the time courses of two regions and determine their <code class="docutils literal notranslate"><span class="pre">r</span></code> correlation. Functional connectivity is then interpreted as follows within the framework of the experiment:</p>
<ul class="simple">
<li><p>strong (<code class="docutils literal notranslate"><span class="pre">r</span></code> close to 1): the two brain regions are involved in similar cognitive processes,</p></li>
<li><p>weak (<code class="docutils literal notranslate"><span class="pre">r</span></code> close to zero): the cognitive processes are independent,</p></li>
<li><p>negative (<code class="docutils literal notranslate"><span class="pre">r</span></code> close to -1): the cognitive processes are mutually exclusive.</p></li>
</ul>
<p>In the example presented in <a class="reference internal" href="#connectivity-fig"><span class="std std-numref">Fig. 56</span></a>, the regions <code class="docutils literal notranslate"><span class="pre">M1</span> <span class="pre">right</span></code> and <code class="docutils literal notranslate"><span class="pre">M1</span> <span class="pre">left</span></code> have a strong functional connectivity between them, and a moderate functional connectivity with the <code class="docutils literal notranslate"><span class="pre">posterior</span> <span class="pre">cingulate</span></code> region.</p>
<div class="tip admonition" id="correlation">
<p class="admonition-title">Correlation measure</p>
<p><a class="reference external" href="https://fr.wikipedia.org/wiki/Corr%C3%A9lation_(statistiques)">Correlation</a> between two time series is a measure that varies between -1 and 1. If the two series are identical (from their mean and variance), the correlation is 1. If the two series are statistically independent, the correlation is close to zero. If the two series are mirror images of each other, the correlation is -1.</p>
</div>
</section>
<section id="functional-connectivity-map">
<h2>Functional connectivity map<a class="headerlink" href="#functional-connectivity-map" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importer les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span><span class="p">,</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiLabelsMasker</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span> <span class="c1"># Fetch data using nilearn</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>


<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Initialise la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="c1"># Importe les données</span>
<span class="n">basc</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_basc_multiscale_2015</span><span class="p">()</span> <span class="c1"># the BASC multiscale atlas</span>
<span class="n">adhd</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_adhd</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>          <span class="c1"># ADHD200 preprocessed data (Athena pipeline)\</span>

<span class="c1"># Paramètres du pré-traitement</span>
<span class="n">num_data</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">high_pass</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">high_variance_confounds</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">time_samp</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Extrait le signal par parcelle pour un atlas fonctionnel (BASC)</span>
<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiLabelsMasker</span><span class="p">(</span>
                                      <span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">],</span>
                                      <span class="n">resampling_target</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                      <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">memory</span><span class="o">=</span><span class="s1">&#39;nilearn_cache&#39;</span><span class="p">,</span>
                                      <span class="n">memory_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # parcels))&quot;</span><span class="p">)</span>

<span class="c1"># Charge les données par voxel</span>
<span class="n">masker_voxel</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiMasker</span><span class="p">(</span><span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span>
                                     <span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="n">tseries_voxel</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries_voxel</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # voxels))&quot;</span><span class="p">)</span>

<span class="c1"># Montre une parcelle</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">num_parcel</span> <span class="o">=</span> <span class="mi">73</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;img == </span><span class="si">{</span><span class="n">num_parcel</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">]),</span>
                  <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                  <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="s2">&quot;région cible (M1 droit)&quot;</span><span class="p">)</span>

<span class="c1"># plot la série temporelle d&#39;une région</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_plot</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;40&#39;</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">time_samp</span><span class="p">],</span> <span class="n">tseries</span><span class="p">[</span><span class="n">time_samp</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">num_parcel</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temps (s.)&#39;</span><span class="p">),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;BOLD (u.a.)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Série temporelle&#39;</span><span class="p">)</span>

<span class="c1"># carte de connectivité</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">seed_to_voxel_correlations</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tseries_voxel</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tseries</span><span class="p">[:,</span> <span class="n">num_parcel</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1"># Show the connectivity map</span>
<span class="n">conn_map</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">seed_to_voxel_correlations</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">conn_map</span><span class="p">,</span>
                       <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                       <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                       <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">59</span><span class="p">),</span>
                       <span class="n">title</span><span class="o">=</span><span class="s2">&quot;carte de connectivité (M1 droit)&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;fcmri-map-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="fcmri-map-fig" style="width: 600px">
<img alt="_images/02d6afdd9a37968583fd91cdfe6f9982c8d9e9f24b415c79f842377fe299a749.png" src="_images/02d6afdd9a37968583fd91cdfe6f9982c8d9e9f24b415c79f842377fe299a749.png" />
<figcaption>
<p><span class="caption-number">Fig. 57 </span><span class="caption-text">Resting-state connectivity maps generated from fMRI data of a participant from the ADHD-200 dataset <span id="id6">[<a class="reference internal" href="references.html#id4" title="HD-200 Consortium. The ADHD-200 consortium: a model to advance the translational potential of neuroimaging in clinical neuroscience. Front. Syst. Neurosci., 6:62, September 2012. doi:https://dx.doi.org/10.3389%2Ffnsys.2012.00062.">3</a>]</span> (bottom, right). The target region used is in the right sensorimotor cortex (top, left) identifying the sensorimotor network. The first five minutes of BOLD activity associated with the target region are shown (top, right). This figure is generated by python code using the <a class="reference external" href="https://nilearn.github.io/">nilearn</a> library (click on + to see the code), and is distributed under the CC-BY license.</span><a class="headerlink" href="#fcmri-map-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The concept of resting-state functional mapping was introduced by Biswal and colleagues (1995) <span id="id7">[<a class="reference internal" href="references.html#id21" title="B Biswal, F Z Yetkin, V M Haughton, and J S Hyde. Functional connectivity in the motor cortex of resting human brain using echo-planar MRI. Magn. Reson. Med., 34(4):537–541, October 1995.">21</a>]</span>. Instead of examining the functionnal connectivity between two regions, they compared the activity of a target region with all voxels in the brain. <span id="id8">[<a class="reference internal" href="references.html#id21" title="B Biswal, F Z Yetkin, V M Haughton, and J S Hyde. Functional connectivity in the motor cortex of resting human brain using echo-planar MRI. Magn. Reson. Med., 34(4):537–541, October 1995.">21</a>]</span> used a region in the right primary sensorimotor cortex. This target region was identified using an activation map and a motor task. Biswal and colleagues then had the idea of observing the BOLD fluctuations in a <strong>resting</strong> condition, in the absence of an experimental task. This map revealed a distributed set of regions (see <a class="reference internal" href="#fcmri-map-fig"><span class="std std-numref">Fig. 57</span></a>, right M1 target), including the left sensorimotor cortex, as well as the supplementary motor area, premotor cortex, and other brain regions known for their involvement in the <strong>motor network</strong>. Initially, this study sparked considerable skepticism, as these patterns of correlated functional activity could have been perceived as reflecting cardiac or respiratory noise.</p>
<div class="tip admonition" id="fluctuations-lentes">
<p class="admonition-title">Slow fluctuations</p>
<p>Another key observation by Biswal and colleagues (1995) <span id="id9">[<a class="reference internal" href="references.html#id21" title="B Biswal, F Z Yetkin, V M Haughton, and J S Hyde. Functional connectivity in the motor cortex of resting human brain using echo-planar MRI. Magn. Reson. Med., 34(4):537–541, October 1995.">21</a>]</span> is that the resting-state BOLD signal is dominated by slow fluctuations, with bursts of activity lasting 20 to 30 seconds, clearly visible in <a class="reference internal" href="#connectivity-fig"><span class="std std-numref">Fig. 56</span></a>. More specifically, the spectrum of the resting-state BOLD signal is dominated by frequencies below 0.08 Hz, and even 0.03-0.05 Hz.</p>
</div>
<div class="tip admonition" id="shmuel-bold">
<p class="admonition-title">Resting-state BOLD activity and electrophysiology</p>
<p>The work of Shmuel and colleagues (2008) <span id="id10">[<a class="reference internal" href="references.html#id24" title="Amir Shmuel and David A Leopold. Neuronal correlates of spontaneous fluctuations in fMRI signals in monkey visual cortex: implications for functional connectivity at rest. Hum. Brain Mapp., 29(7):751–761, July 2008.">22</a>]</span> demonstrated that resting-state BOLD activity correlates with spontaneous fluctuations in neuronal activity in the visual cortex of an anesthetized macaque. This shows that functional connectivity reflects at least partially the synchrony of neuronal activity, and not simply physiological noise (cardiac, respiratory).</p>
</div>
</section>
<section id="default-mode-network">
<h2>Default mode network<a class="headerlink" href="#default-mode-network" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importe les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span><span class="p">,</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiLabelsMasker</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span> <span class="c1"># Fetch data using nilearn</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>


<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Initialise la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="c1"># Importe les données</span>
<span class="n">basc</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_basc_multiscale_2015</span><span class="p">()</span> <span class="c1"># the BASC multiscale atlas</span>
<span class="n">adhd</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_adhd</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>          <span class="c1"># ADHD200 preprocessed data (Athena pipeline)\</span>

<span class="c1"># Paramètres du pré-traitement</span>
<span class="n">num_data</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">high_pass</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">high_variance_confounds</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">time_samp</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Extrait le signal par parcelle pour un atlas fonctionnel (BASC)</span>
<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiLabelsMasker</span><span class="p">(</span>
                                      <span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">],</span>
                                      <span class="n">resampling_target</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                      <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">memory</span><span class="o">=</span><span class="s1">&#39;nilearn_cache&#39;</span><span class="p">,</span>
                                      <span class="n">memory_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # parcels))&quot;</span><span class="p">)</span>

<span class="c1"># Charge les données par voxel</span>
<span class="n">masker_voxel</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiMasker</span><span class="p">(</span><span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span>
                                     <span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="n">tseries_voxel</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries_voxel</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # voxels))&quot;</span><span class="p">)</span>

<span class="c1"># Montre une parcelle</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">num_parcel</span> <span class="o">=</span> <span class="mi">17</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;img == </span><span class="si">{</span><span class="n">num_parcel</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">]),</span>
                  <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                  <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="s2">&quot;région cible (PCC)&quot;</span><span class="p">)</span>

<span class="c1"># plot la série temporelle d&#39;une région</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_plot</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;40&#39;</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">time_samp</span><span class="p">],</span> <span class="n">tseries</span><span class="p">[</span><span class="n">time_samp</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">num_parcel</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temps (s.)&#39;</span><span class="p">),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;BOLD (u.a.)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Série temporelle&#39;</span><span class="p">)</span>

<span class="c1"># carte de connectivité</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">seed_to_voxel_correlations</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tseries_voxel</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tseries</span><span class="p">[:,</span> <span class="n">num_parcel</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1"># Show the connectivity map</span>
<span class="n">conn_map</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">seed_to_voxel_correlations</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">conn_map</span><span class="p">,</span>
                       <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                       <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                       <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">52</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span>
                       <span class="n">title</span><span class="o">=</span><span class="s2">&quot;carte de connectivité (PCC)&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;fcmri-dmn-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="fcmri-dmn-fig" style="width: 600px">
<img alt="_images/7726eb6caebd44a1e93b5b9b8ed1de66e972eb49ed952be42df33e9980a9ec7c.png" src="_images/7726eb6caebd44a1e93b5b9b8ed1de66e972eb49ed952be42df33e9980a9ec7c.png" />
<figcaption>
<p><span class="caption-number">Fig. 58 </span><span class="caption-text">Resting-state connectivity maps generated from fMRI data of a participant from the ADHD-200 dataset <span id="id11">[<a class="reference internal" href="references.html#id4" title="HD-200 Consortium. The ADHD-200 consortium: a model to advance the translational potential of neuroimaging in clinical neuroscience. Front. Syst. Neurosci., 6:62, September 2012. doi:https://dx.doi.org/10.3389%2Ffnsys.2012.00062.">3</a>]</span> (bottom, right). The target region used is in the posterior cingulate cortex (top, left) identifying the default mode network. The first five minutes of BOLD activity associated with the target region are shown (top, right). This figure is generated by python code using the <a class="reference external" href="https://nilearn.github.io/">nilearn</a> library (click on + to see the code), and is distributed under the CC-BY license.</span><a class="headerlink" href="#fcmri-dmn-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The credibility of resting-state connectivity maps was strengthened when different research groups were able to identify other networks using different target regions, including the visual and auditory networks. However, it was the study of Greicius et colleagues, in 2003 <span id="id12">[<a class="reference internal" href="references.html#id23" title="Michael D Greicius, Ben Krasnow, Allan L Reiss, and Vinod Menon. Functional connectivity in the resting brain: a network analysis of the default mode hypothesis. Proc. Natl. Acad. Sci. U. S. A., 100(1):253–258, January 2003.">23</a>]</span> that sparked enourmous interest in resting-state connectivity maps using a target region in the posterior cingulate cortext (PCC) to identify a functional network that had not yet been identified: the <strong>default mode network</strong> (see <a class="reference internal" href="#fcmri-dmn-fig"><span class="std std-numref">Fig. 58</span></a>, PCC target). We will discuss the origins of this network in the next section.</p>
<div class="caution attention admonition" id="fcmri-map-warning">
<p class="admonition-title">Intra- and inter-individual variability</p>
<p><a class="reference internal" href="#fcmri-dmn-fig"><span class="std std-numref">Fig. 58</span></a> may give the impression that connectivity networks are extremely stable. In reality, connectivity maps vary significantly over time, meaning when looking at different windows of activity for the same individual, and also between individuals. Indeed, the coordinates of a target region may be partially inacurrate even with image registration. Characterizing the intra- and inter-individual variability of connectivity maps is an active area of research.</p>
</div>
</section>
<section id="deactivations">
<h2>Deactivations<a class="headerlink" href="#deactivations" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importer les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">image</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">masking</span>
<span class="kn">from</span> <span class="nn">nilearn.glm.first_level</span> <span class="kn">import</span> <span class="n">FirstLevelModel</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiLabelsMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>

<span class="c1"># initialisation de la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># load fMRI data</span>
<span class="n">subject_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_spm_auditory</span><span class="p">()</span>
<span class="n">fmri_img</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">concat_imgs</span><span class="p">(</span><span class="n">subject_data</span><span class="o">.</span><span class="n">func</span><span class="p">)</span>

<span class="c1"># Make an average</span>
<span class="n">mean_img</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">mean_img</span><span class="p">(</span><span class="n">fmri_img</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">masking</span><span class="o">.</span><span class="n">compute_epi_mask</span><span class="p">(</span><span class="n">mean_img</span><span class="p">)</span>

<span class="c1"># Clean and smooth data</span>
<span class="n">fmri_img</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">clean_img</span><span class="p">(</span><span class="n">fmri_img</span><span class="p">,</span> <span class="n">high_pass</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">t_r</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fmri_img</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">smooth_img</span><span class="p">(</span><span class="n">fmri_img</span><span class="p">,</span> <span class="mf">8.</span><span class="p">)</span>

<span class="c1"># load events</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">subject_data</span><span class="p">[</span><span class="s1">&#39;events&#39;</span><span class="p">])</span>

<span class="c1"># Fit model</span>
<span class="n">fmri_glm</span> <span class="o">=</span> <span class="n">FirstLevelModel</span><span class="p">(</span><span class="n">t_r</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                           <span class="n">drift_model</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
                           <span class="n">signal_scaling</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">mask_img</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>                           
                           <span class="n">minimize_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">fmri_glm</span> <span class="o">=</span> <span class="n">fmri_glm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fmri_img</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>

<span class="c1"># Extract activation clusters</span>
<span class="n">z_map</span> <span class="o">=</span> <span class="n">fmri_glm</span><span class="o">.</span><span class="n">compute_contrast</span><span class="p">(</span><span class="s1">&#39;active - rest&#39;</span><span class="p">)</span>

<span class="c1"># plot activation map</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span>
        <span class="n">z_map</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
        <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="mf">3.</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span> <span class="n">bg_img</span><span class="o">=</span><span class="n">mean_img</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;carte d</span><span class="se">\&#39;</span><span class="s1">activation (auditif)&#39;</span><span class="p">)</span>

<span class="c1"># Glue the figure</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;deactivation-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="deactivation-fig" style="width: 600px">
<img alt="_images/416a69c6e31de5a1a2020f5b7ef0e111ea19749a972274f12f7bc6c1db1ba1f1.png" src="_images/416a69c6e31de5a1a2020f5b7ef0e111ea19749a972274f12f7bc6c1db1ba1f1.png" />
<figcaption>
<p><span class="caption-number">Fig. 59 </span><span class="caption-text">Individual activation map in an auditory paradigm (<a class="reference external" href="https://www.fil.ion.ucl.ac.uk/spm/data/auditory/">spm_auditory</a> dataset). The significance threshold is selected liberally (<code class="docutils literal notranslate"><span class="pre">|z|&gt;2</span></code>). A moderate deactivation is identified in different regions of the brain, including the posterior cingulate cortex (PCC) and the medial prefrontal cortex (mPFC). The PCC and the mPFC are key regions of the default mode network, This figure is generated by python code using the <a class="reference external" href="https://nilearn.github.io/">nilearn</a> library(click on + to see the code), and is distributed under the CC-BY license.</span><a class="headerlink" href="#deactivation-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The default mode network (DMN) was initially discoverd through activation studies <span id="id13">[<a class="reference internal" href="references.html#id26" title="G L Shulman, J A Fiez, M Corbetta, R L Buckner, F M Miezin, M E Raichle, and S E Petersen. Common blood flow changes across visual tasks: II. decreases in cerebral cortex. J. Cogn. Neurosci., 9(5):648–663, 1997.">24</a>]</span>, which combined 9 PET studies using the same control condition od “rest” (consisting of passively viewing visual stimuli). The authors demonstrated that a set of regions are consistently more engaged at rest than during various cognitively demanding tasks. These regions include notably the posterior cingulate cortex (PCC). The “<em>default mode hypothesis</em>” posits that there are certain introspective cognitive processes that are systematically present in a resting state, and there exists a functional network that supports this “default” activity <span id="id14">[<a class="reference internal" href="references.html#id27" title="M E Raichle, A M MacLeod, A Z Snyder, W J Powers, D A Gusnard, and G L Shulman. A default mode of brain function. Proc. Natl. Acad. Sci. U. S. A., 98(2):676–682, January 2001.">25</a>]</span>. Resting-state fMRI connectivity maps with a target region in the PCC also identify the default mode network, as seen in <a class="reference internal" href="#fcmri-dmn-fig"><span class="std std-numref">Fig. 58</span></a>.</p>
</section>
<section id="dan-and-negative-correlations">
<h2>DAN and negative correlations<a class="headerlink" href="#dan-and-negative-correlations" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importer les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">image</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">masking</span>
<span class="kn">from</span> <span class="nn">nilearn.glm.first_level</span> <span class="kn">import</span> <span class="n">FirstLevelModel</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiLabelsMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>

<span class="c1"># initialisation de la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># Importe les données</span>
<span class="n">basc</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_basc_multiscale_2015</span><span class="p">()</span> <span class="c1"># the BASC multiscale atlas</span>
<span class="n">adhd</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_adhd</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>          <span class="c1"># ADHD200 preprocessed data (Athena pipeline)\</span>

<span class="c1"># Paramètres du pré-traitement</span>
<span class="n">num_data</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">high_pass</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">high_variance_confounds</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">time_samp</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Extrait le signal par parcelle pour un atlas fonctionnel (BASC)</span>
<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiLabelsMasker</span><span class="p">(</span>
                                      <span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">],</span>
                                      <span class="n">resampling_target</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                      <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">memory</span><span class="o">=</span><span class="s1">&#39;nilearn_cache&#39;</span><span class="p">,</span>
                                      <span class="n">memory_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # parcels))&quot;</span><span class="p">)</span>

<span class="c1"># Charge les données par voxel</span>
<span class="n">masker_voxel</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiMasker</span><span class="p">(</span><span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span>
                                     <span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="n">tseries_voxel</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries_voxel</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # voxels))&quot;</span><span class="p">)</span>

<span class="c1"># Applique une correction du signal global</span>
<span class="kn">from</span> <span class="nn">nilearn.signal</span> <span class="kn">import</span> <span class="n">clean</span> <span class="k">as</span> <span class="n">signal_clean</span>
<span class="n">gb_signal</span> <span class="o">=</span> <span class="n">signal_clean</span><span class="p">(</span>
                        <span class="n">tseries</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">]),</span>
                        <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                        <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">],</span> <span class="n">confounds</span><span class="o">=</span><span class="n">gb_signal</span><span class="p">)</span>
<span class="n">tseries_voxel</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">],</span> <span class="n">confounds</span><span class="o">=</span><span class="n">gb_signal</span><span class="p">)</span>

<span class="c1"># Montre une parcelle</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">num_parcel</span> <span class="o">=</span> <span class="mi">113</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;img == </span><span class="si">{</span><span class="n">num_parcel</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">]),</span>
                  <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                  <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                  <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="s2">&quot;région cible (FEF)&quot;</span><span class="p">)</span>

<span class="c1"># plot la série temporelle d&#39;une région</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax_plot</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;40&#39;</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">time_samp</span><span class="p">],</span> <span class="n">tseries</span><span class="p">[</span><span class="n">time_samp</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">num_parcel</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temps (s.)&#39;</span><span class="p">),</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;BOLD (u.a.)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Série temporelle&#39;</span><span class="p">)</span>

<span class="c1"># carte de connectivité</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">seed_to_voxel_correlations</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tseries_voxel</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">tseries</span><span class="p">[:,</span> <span class="n">num_parcel</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="c1"># Show the connectivity map</span>
<span class="n">conn_map</span> <span class="o">=</span> <span class="n">masker_voxel</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">seed_to_voxel_correlations</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_stat_map</span><span class="p">(</span><span class="n">conn_map</span><span class="p">,</span>
                       <span class="n">threshold</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                       <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                       <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">28</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
                       <span class="n">display_mode</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>
                       <span class="n">title</span><span class="o">=</span><span class="s2">&quot;carte de connectivité (FEF)&quot;</span><span class="p">)</span>

<span class="c1"># Glue the figure</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;negative-DMN-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="negative-dmn-fig" style="width: 600px">
<img alt="_images/b3aebed9fd4b0efe0d1cda78041a3aa72ecc0776e5645caa98a10875324d7dc4.png" src="_images/b3aebed9fd4b0efe0d1cda78041a3aa72ecc0776e5645caa98a10875324d7dc4.png" />
<figcaption>
<p><span class="caption-number">Fig. 60 </span><span class="caption-text">A target region is selected at the level of the frontal eye field (FEF) to generate a connectivity map for a participant from the ADHD-200 dataset <span id="id15">[<a class="reference internal" href="references.html#id4" title="HD-200 Consortium. The ADHD-200 consortium: a model to advance the translational potential of neuroimaging in clinical neuroscience. Front. Syst. Neurosci., 6:62, September 2012. doi:https://dx.doi.org/10.3389%2Ffnsys.2012.00062.">3</a>]</span>. The significance threshold is selected liberally (<code class="docutils literal notranslate"><span class="pre">|r|&gt;0.2</span></code>). In addition to the dorsal attention network (DAN) associated with the FEF, the connectivity map highlights a negative correlation with the PCC and the anterior cingulate cortex (ACC). The ACC and the PCC are key regions of the default mode network. This figure is generated by python code using the <a class="reference external" href="https://nilearn.github.io/">nilearn</a> library (click on + to see the code), and is distributed under the CC-BY license.</span><a class="headerlink" href="#negative-dmn-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The default mode network is not the only one that can be identified during rest. We have already seen the sensorimotor network, which was first identified by Biswal and colleagues. Another network commonly examined in the litterature is the dorsal attention network (DAN), which includes the superior intraparietal sulcus and the frontal eye field. The DAN is often identified as activated in experiments using cognitively demanding fMRI tasks and is sometimes referred to as the “task positive network” - even though it is not positively engaged by all tasks. In 2005, Fox et al. <span id="id16">[<a class="reference internal" href="references.html#id28" title="Michael D Fox, Abraham Z Snyder, Justin L Vincent, Maurizio Corbetta, David C Van Essen, and Marcus E Raichle. The human brain is intrinsically organized into dynamic, anticorrelated functional networks. Proc. Natl. Acad. Sci. U. S. A., 102(27):9673–9678, July 2005.">26</a>]</span> observed a negative correlation between the DAN and the default mode network. This analysis reinforces the notion of spontaneous transitions between a state directed towards external stimuli and an introspective state, reflecting the competition between two distributed networks.</p>
<div class="caution attention admonition" id="negative-r-warning">
<p class="admonition-title">Controversies on global signal regression</p>
<p>The negative correlations in <a class="reference internal" href="#negative-dmn-fig"><span class="std std-numref">Fig. 60</span></a> are strong only when certain data denoising steps are applied, notably the <em>global signal regression</em>. A significant controversy has arisen around negative connections, as some researchers believe they are an artifact related to this preprocessing step. However, negative correlations can be observed robustly in participants who move very little, and thus have particularly clean signals. Their amplitude, however, is low in the absence of global signal regression.</p>
</div>
<div class="tip admonition" id="intrinseque-tip">
<p class="admonition-title">Intrinsic and extrinsic activity</p>
<p>Resting-state networks can be observed even in the presence of a task. Rather than opposing the concepts of rest and task, it is common to refer to intrinsic and extrinsic activity. <strong>Extrinsic activity</strong> is the activity elicited by a task and reflects how the environment influences brain activity. In contrast, <strong>intrinsic activity</strong> refers to brain activity that arises spontaneously and is independent of external stimuli. Both types of activity are always present and can interact with each other.</p>
</div>
</section>
<section id="connectomes-et-networks">
<h2>Connectomes et networks<a class="headerlink" href="#connectomes-et-networks" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importe les librairies</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">image</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">masking</span>
<span class="kn">from</span> <span class="nn">nilearn.glm.first_level</span> <span class="kn">import</span> <span class="n">FirstLevelModel</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiLabelsMasker</span>
<span class="kn">from</span> <span class="nn">nilearn.input_data</span> <span class="kn">import</span> <span class="n">NiftiMasker</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>

<span class="c1"># initialisation de la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="c1"># Importe les données</span>
<span class="n">basc</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_basc_multiscale_2015</span><span class="p">()</span> <span class="c1"># the BASC multiscale atlas</span>
<span class="n">adhd</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_adhd</span><span class="p">(</span><span class="n">n_subjects</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>          <span class="c1"># ADHD200 preprocessed data (Athena pipeline)\</span>

<span class="c1"># Paramètres du pré-traitement</span>
<span class="n">num_data</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">high_pass</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">high_variance_confounds</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">time_samp</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Extrait le signal par parcelle pour un atlas fonctionnel (BASC)</span>
<span class="n">masker</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">NiftiLabelsMasker</span><span class="p">(</span>
                                      <span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">],</span>
                                      <span class="n">resampling_target</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                      <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                                      <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                      <span class="n">high_variance_confounds</span><span class="o">=</span><span class="n">high_variance_confounds</span><span class="p">,</span>
                                      <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">memory</span><span class="o">=</span><span class="s1">&#39;nilearn_cache&#39;</span><span class="p">,</span>
                                      <span class="n">memory_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                      <span class="n">smoothing_fwhm</span><span class="o">=</span><span class="n">fwhm</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time series with shape </span><span class="si">{</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (# time points, # parcels))&quot;</span><span class="p">)</span>


<span class="c1"># Applique une correction du signal global</span>
<span class="kn">from</span> <span class="nn">nilearn.signal</span> <span class="kn">import</span> <span class="n">clean</span> <span class="k">as</span> <span class="n">signal_clean</span>
<span class="n">gb_signal</span> <span class="o">=</span> <span class="n">signal_clean</span><span class="p">(</span>
                        <span class="n">tseries</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">tseries</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">]),</span>
                        <span class="n">high_pass</span><span class="o">=</span><span class="n">high_pass</span><span class="p">,</span>
                        <span class="n">t_r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tseries</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">adhd</span><span class="o">.</span><span class="n">func</span><span class="p">[</span><span class="n">num_data</span><span class="p">],</span> <span class="n">confounds</span><span class="o">=</span><span class="n">gb_signal</span><span class="p">)</span>

<span class="c1"># Affiche le template</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">basc</span><span class="p">[</span><span class="s1">&#39;scale122&#39;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;parcellisation&quot;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;turbo&quot;</span><span class="p">)</span>

<span class="c1"># We generate a connectome</span>
<span class="kn">from</span> <span class="nn">nilearn.connectome</span> <span class="kn">import</span> <span class="n">ConnectivityMeasure</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">ConnectivityMeasure</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;correlation&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="n">tseries</span><span class="p">]))</span>

<span class="c1"># we use scipy&#39;s hierarchical clustering implementation</span>
<span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span><span class="p">,</span> <span class="n">cut_tree</span>
<span class="c1"># That&#39;s the hierarchical clustering step</span>
<span class="n">hier</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span> <span class="c1"># scipy&#39;s hierarchical clustering</span>
<span class="c1"># HAC proceeds by iteratively merging brain regions, which can be visualized with a tree</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">dendrogram</span><span class="p">(</span><span class="n">hier</span><span class="p">,</span> <span class="n">get_leaves</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Generate a dendrogram from the hierarchy</span>
<span class="n">order</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;leaves&#39;</span><span class="p">)</span> <span class="c1"># Extract the order on parcels from the dendrogram</span>
<span class="n">part</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">cut_tree</span><span class="p">(</span><span class="n">hier</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>

<span class="c1"># Montre le connectome</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax_plot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;régions&#39;</span><span class="p">)</span>
<span class="n">ax_plot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;connectome&#39;</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">ax_plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">conn</span><span class="p">[</span><span class="n">order</span><span class="p">,</span> <span class="p">:][:,</span> <span class="n">order</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;turbo&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">)</span>

<span class="c1"># Montre les réseaux</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">part_img</span> <span class="o">=</span> <span class="n">masker</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">122</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># note the sneaky shift to 1-indexing</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">part_img</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="s2">&quot;réseaux&quot;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;turbo&quot;</span><span class="p">,</span>
                  <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span>
                  <span class="n">cut_coords</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">52</span><span class="p">,</span> <span class="mi">26</span><span class="p">])</span>

<span class="c1"># Glue the figure</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;network-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="network-fig" style="width: 800px">
<img alt="_images/0957d52e9e8014340dd2be5dcc4ee56671d001b7a8eafb0e86eab17901d48cb3.png" src="_images/0957d52e9e8014340dd2be5dcc4ee56671d001b7a8eafb0e86eab17901d48cb3.png" />
<figcaption>
<p><span class="caption-number">Fig. 61 </span><span class="caption-text">A functional brain parcellation with 122 parcels is presented on the left (BASC). In the center, a matrix is shown where each element represents the correlation between the activity of two parcels. The parcels have been ordered to highlight diagonal squares: these are groups or regions whose activity strongly correlates with each other and less so with the rest of the brain. Clustering algorithms automatically detect these groups of parcels, called functional networks. An example of functional networks generated with hierarchical clustering is presented on the right, which identifies, among others, the default mode network. This figure is generated by python code using the <a class="reference external" href="https://nilearn.github.io/">nilearn</a> library (click on + to see the code), and is distributed under the CC-BY license.</span><a class="headerlink" href="#network-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>We have repeatedly mentioned  <em><strong>functional network</strong></em>, but without really defining what it is. When using a connectivity map, the functionnal network is the set of regions that appear in the map and are therefore connected to our target region. However, this approach depends on the target region. Yet, it is intuitive that all connectivity maps using targets in, for example, the default mode network will look similar. To formalize this intuition, we need to consider the connectivity of <em>all</em> pairs of regions simultaneously, a notion called functional connectome. By using unsupervised learning techniques, such as clustering, it is possible to identify groups of brain regions that are strongly connected to each other and weakly connected to the rest of the brain. This is the most common definition of a functional network. This approach allows for the division of the brain into networks, in an automatic and data-driven way, see <a class="reference internal" href="#network-fig"><span class="std std-numref">Fig. 61</span></a> (bottom, left).</p>
<div class="tip admonition" id="connectome-tip">
<p class="admonition-title">Connectome</p>
<p>A <strong>functional connectome</strong> is a matrix representing all the (functional) connexions in the brain, see <a class="reference internal" href="#network-fig"><span class="std std-numref">Fig. 61</span></a> (right). Each row and each column represent a brain region. The <code class="docutils literal notranslate"><span class="pre">r</span></code> values found in the matrix correspond to the correlation of the temporal activity of the regions, as seen in <a class="reference internal" href="#connectivity-fig"><span class="std std-numref">Fig. 56</span></a>. To generate a connectome, we start by selecting a brain parcellation into regions (<a class="reference internal" href="#network-fig"><span class="std std-numref">Fig. 61</span></a>, top left), then calculate the correlation of the temporal activity for all pairs of parcels in the brain.</p>
</div>
</section>
<section id="brain-networks-atlases">
<h2>Brain networks atlases<a class="headerlink" href="#brain-networks-atlases" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-input tag_remove-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span> <span class="c1"># Fetch data using nilearn</span>
<span class="n">atlas_yeo</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_yeo_2011</span><span class="p">()</span>        <span class="c1"># the Yeo-Krienen atlas</span>

<span class="c1"># initialisation de la figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="c1"># Let&#39;s plot the Yeo-Krienen 7 clusters parcellation</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">math_img</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Yeo-Krienen atlas-7&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;(img==1).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Visuel&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;2 * (img==2).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sensorimoteur&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;3 * (img==3).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Attentionnel dorsal&#39;</span><span class="p">,</span>
                  <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">27</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;4 * (img==4).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Attentionnel ventral / salience&#39;</span><span class="p">,</span>
                  <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;5 * (img==5).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mésolimbique&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;6 * (img==6).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;frontopariétal&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ax_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span><span class="p">(</span><span class="n">math_img</span><span class="p">(</span><span class="s1">&#39;7 * (img==7).astype(</span><span class="se">\&#39;</span><span class="s1">float</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">atlas_yeo</span><span class="o">.</span><span class="n">thick_7</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;mode par défaut&#39;</span><span class="p">,</span>
                  <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax_plot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="c1"># Glue the figure</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;yeo-krienen-fig&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="yeo-krienen-fig" style="width: 800px">
<img alt="_images/0ab7cdd756be7cdbe23080086e19304ffb789a50f6f5e49c14bcc0c4f74c0564.png" src="_images/0ab7cdd756be7cdbe23080086e19304ffb789a50f6f5e49c14bcc0c4f74c0564.png" />
<figcaption>
<p><span class="caption-number">Fig. 62 </span><span class="caption-text">The Yeo-Krienen atlas <span id="id17">[<a class="reference internal" href="references.html#id29" title="B T Thomas Yeo, Fenna M Krienen, Jorge Sepulcre, Mert R Sabuncu, Danial Lashkari, Marisa Hollinshead, Joshua L Roffman, Jordan W Smoller, Lilla Zöllei, Jonathan R Polimeni, Bruce Fischl, Hesheng Liu, and Randy L Buckner. The organization of the human cerebral cortex estimated by intrinsic functional connectivity. J. Neurophysiol., 106(3):1125–1165, September 2011.">27</a>]</span> is constructed through clustering analysis from resting-state fMRI data of a large number of participants. The networks are defined at multiple resolutions in this altas (7 and 17). Here, the partition into 7 large distributed networks is presented. This figure is generated by python code using the <a class="reference external" href="https://nilearn.github.io/">nilearn</a> library (click on + to see the code), and is distributed under the CC-BY license.</span><a class="headerlink" href="#yeo-krienen-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>There are standard atlases of resting-state networks that have been generated on a large number of participants. The atlas developed by Yeo, Krienen and colleagues <span id="id18">[<a class="reference internal" href="references.html#id29" title="B T Thomas Yeo, Fenna M Krienen, Jorge Sepulcre, Mert R Sabuncu, Danial Lashkari, Marisa Hollinshead, Joshua L Roffman, Jordan W Smoller, Lilla Zöllei, Jonathan R Polimeni, Bruce Fischl, Hesheng Liu, and Randy L Buckner. The organization of the human cerebral cortex estimated by intrinsic functional connectivity. J. Neurophysiol., 106(3):1125–1165, September 2011.">27</a>]</span> is widely used and identifies seven major networks, as seen in <a class="reference internal" href="#yeo-krienen-fig"><span class="std std-numref">Fig. 62</span></a>. Some of these networks have already been discussed in this chapter: the default mode network, the dorsal attention network, and the sensorimotor network. We should add two other associative networks: the frontoparietal and ventral attentional networks. There is also a visual network and a mesolimbic netwrok involving the temporal pole and orbitofrontal cortex. Note that this altas ignores all subcortical structures, and that there is no exact number of brain networks, but rather a hierarchy of more or less specialized networks.</p>
<div class="tip admonition" id="number-networks-tip">
<p class="admonition-title">Multiple resting-state networks</p>
<p>Many articles have studied a partition into 7 cortical networks. However, the study by Yeo, Krienen et al. <span id="id19">[<a class="reference internal" href="references.html#id29" title="B T Thomas Yeo, Fenna M Krienen, Jorge Sepulcre, Mert R Sabuncu, Danial Lashkari, Marisa Hollinshead, Joshua L Roffman, Jordan W Smoller, Lilla Zöllei, Jonathan R Polimeni, Bruce Fischl, Hesheng Liu, and Randy L Buckner. The organization of the human cerebral cortex estimated by intrinsic functional connectivity. J. Neurophysiol., 106(3):1125–1165, September 2011.">27</a>]</span> also proposed a partition into 17 sub-networks, and since then, several atlases with hundreds of regions have been proposed. You can use this <a class="reference external" href="https://simexp.github.io/multiscale_dashboard/index.html">interactive tool</a> to explore the multi-scale organization of functional networks interactively, using the MIST atlas <span id="id20">[<a class="reference internal" href="references.html#id31" title="S Urchs, J Armoza, Y Benhajali, J St-Aubin, and others. MIST: a multi-resolution parcellation of functional brain networks [version 2; peer review: 4 approved]. MNI Open Res., 2019.">28</a>]</span>.</p>
</div>
</section>
<section id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Functional connectivity involves measuring the coherence (correlation) between the activity of two regions (or voxels) in the brain.</p></li>
<li><p>A functional connectivity map allows the study of connectivity between a target region and the rest of the brain.</p></li>
<li><p>A functional network is a group of regions whose spontaneous activity exhibits strong intra-network functional connectivity and weak connectivity with the rest of the brain. Various resting-state network atlases exist, at different scales.</p></li>
</ul>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title">Exercise 1</p>
<p>Connectivity map: True/False</p>
<ol class="arabic simple">
<li><p>A connectivity map changes if we change the target region.</p></li>
<li><p>To define a target region, we need to do an activation map.</p></li>
<li><p>The values in a connectivity map vary between 0 and 1.</p></li>
<li><p>An fMRI activation map is a tool that can be used to identify the default mode network.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercise 2</p>
<p>Functional networks: True/False</p>
<ol class="arabic simple">
<li><p>A functional network is composed of voxels/regions exhibiting strong functional connectivity</p></li>
<li><p>The regions within the default mode network are negatively correlated with the regions with the sensorimotor network.</p></li>
<li><p>Resting-state network atlases identify between seven and several hundred resting-state networks.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercise 3</p>
<p>Choose the correct answer:</p>
<ol class="arabic simple">
<li><p>Spontaneous brain activity is only observed in a resting state.</p></li>
<li><p>Brain activity evoked by a task can be characterized by an fMRI activation map.</p></li>
<li><p>Connectivity maps can reveal brain activity during a task or at rest.</p></li>
<li><p>Answers 1 and 2.</p></li>
<li><p>Answers 2 and 3.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercise 4</p>
<p>Choose the correct answer:</p>
<ol class="arabic simple">
<li><p>Functional connectivity is measured between two regions.</p></li>
<li><p>Functional connectivity is measured between one region and all voxels in the brain.</p></li>
<li><p>Functional connectivity is measured between all pairs of regions in an atlas.</p></li>
<li><p>Answers 1 and 3.</p></li>
<li><p>Answers 1, 2 and 3.</p></li>
</ol>
</div>
<div class="note admonition">
<p class="admonition-title">Exercise 5</p>
<p>We have a brain region atlas and we select a target region in the posterior cingulate cortex (PCC). For a resting-state fMRI dataset, we calculate a functional connectome using the atlas, as well as a connectivity map using the PCC as the target region. Explain one similarity and one difference between the column of the connectome corresponding to the PCC and the connectivity map (PCC target).</p>
</div>
<div class="note admonition">
<p class="admonition-title">Exercise 6</p>
<p>We compare resting-state functional connectivity between a group of young people and a group of older people. Connectivity maps are generated with a target region in the posterior cingulate cortex. Statistical tests are applied, and a decrease in connectivity with the medial frontal cortex is identified. Propose three hypotheses that could explain this observation.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Exercise 7</p>
<p>To answer this question, read the following article by Shukla et al., “<em>Aberrant Frontostriatal Connectivity in Negative Symptoms of Schizophrenia</em>”, publié dans Schizophrenia Bulletin (2019, 45(5): 1051-59) and available in open access at this <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6737477/">address</a>. The following questions require short answers.</p>
<ol class="arabic simple">
<li><p>Which software was used to analyze the fMRI data?</p></li>
<li><p>What experimental condition was used during the fMRI acquisitions?</p></li>
<li><p>What was the spatial smoothing parameter?</p></li>
<li><p>Were the data corrected for motion? How?</p></li>
<li><p>What filtering procedures were applied?</p></li>
<li><p>In which stereotaxic space were the group analyses conducted?</p></li>
<li><p>Which atlas of regions was used?</p></li>
<li><p>What type of connectivity measure is used in thise article?</p></li>
</ol>
</div>
</section>
<section id="bonus">
<h2>Bonus<a class="headerlink" href="#bonus" title="Link to this heading">#</a></h2>
<p>These bonus exercises are related to the following video “resting-state network”:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Youtube</span>
<span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/_Iph3WW9UOU?start=18&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><iframe width="560" height="315" src="https://www.youtube.com/embed/_Iph3WW9UOU?start=18" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div></div>
</div>
<div class="note admonition">
<p class="admonition-title">Bonus exercise 1</p>
<p>“La septième jour” (sic), excerpt in French with English subtitles: 0:54 - 4:35</p>
<ol class="arabic simple">
<li><p>Who does the young man represent?</p></li>
<li><p>What result is he referring to?</p></li>
<li><p>Who does the young woman represent?</p></li>
<li><p>What result is she referring to?</p></li>
<li><p>Why call this film “la septième jour” (“the seventh day”) ?</p></li>
</ol>
</div>
<div class="tip admonition" id="neuro-meteorology-tip">
<p class="admonition-title">Excerpt from “Neuro meteorology”: 4:48 - 5:30</p>
<p>Let’s have a look at upcoming intrinsic activiy for the weekend.
As you can see here, the default mode network and task positive network are up to their usual shenanigans, in and out, yin and yang. Looks like the usual pattern of daydreaming and intense concentration for the weekend.
Default looking a little bit dominant.
Visual looking good, motor looking good, as long as there are no sudden alcoholic fluctuations in form the south.
An updated real-time satellite imagery indicates some turbulence in the precuneus region that could get very interesting early in the week.
But, as the latin philosopher Seneca said: rest is far from restful.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Bonus exercise 2</p>
<p>“Neuro meteorology”: 4:48 - 5:30</p>
<ol class="arabic simple">
<li><p>Which networks are being discussed here?</p></li>
<li><p>Why does he describe the default mode network and the “task-positive” network as “Yin and yang”?</p></li>
<li><p>Are there any networks missing in this prediction?</p></li>
<li><p>Why are turbulences in the precuneus (or rather the posterior cingulate cortex) interesting?</p></li>
</ol>
</div>
<div class="tip admonition" id="hardball-tip">
<p class="admonition-title">Excerpt from “Hardball”: 8:01 - 9:46</p>
<ul class="simple">
<li><p>Host (H): “Welcome, with me today we have two esteemed researchers. On my right, Dr Yann Schnizel, and on my left, Dr Paul Salami. Are you ready to knock some balls?”</p></li>
<li><p>Paul Salami (PS): “Now I’m going to say that the growth in default mode and resting state literature proposes good questions and good experiments, and these are all largely beneficial to the youngsters making their way to research, but I honestly don’t think that studying resting-state is particularly useful. You want to study behavior, you do it the old-fashioned way, like we used to do it. You’d do it experimentally.”</p></li>
<li><p>Yann Schnizel (YS): “This is not so! The important distinction is not between rest and tasks, but rather between intrinsic and evoked activity.”</p></li>
<li><p>PS: “If we both agree that spontaneous activity is present in all cognitive states, I don’t see why we have to link it specifically, specifically right, to rest.”</p></li>
<li><p>YS: “We certainly don’t need to exclusively study it at rest, but the resting state is the condition under which these spontaneous fluctuations have most extensively been studied.”</p></li>
<li><p>PS: “But that is fundamentally unpsychological!”</p></li>
<li><p>YS: “No!”</p></li>
<li><p>PS: “Unpsychological!”</p></li>
<li><p>YS: “YOU are fundamentally unpsychological!”</p></li>
<li><p>PS: “At least I’m willing to study cognition in the moment of the cognitive event.”</p></li>
<li><p>H: “Whoa whoa gentlemen, it’s getting a bit hot in here! Let’s take things down a notch. Actually, looks like we’re just about out of time.”
(fight between PS and YS)</p></li>
<li><p>H: “Next week on “cluster analysis”, we will be hitting the road with Michael Milham, legendary folk singer. He’s traveling the road sharing the history of the resting-state network, in songs. Thank you for watching cluster analysis of the resting-state network,”</p></li>
</ul>
</div>
<div class="note admonition">
<p class="admonition-title">Bonus exercise 3</p>
<p>“Hardball”: 8:01 - 9:46</p>
<ol class="arabic simple">
<li><p>Is it true that spontaneous activity is present both at rest and during a task?</p></li>
<li><p>Is it true that spontaneous activity has been mainly studied in a resting state in fMRI?</p></li>
<li><p>In what way is it “unpsychological” to study a resting condition?</p></li>
<li><p>Open question: is one of them right? Or both?</p></li>
</ol>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="irm_fonctionnelle.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">IRM fonctionnelle</p>
      </div>
    </a>
    <a class="right-next"
       href="irm_diffusion.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">IRM de diffusion</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Functional connectivity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-connectivity-map">Functional connectivity map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#default-mode-network">Default mode network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deactivations">Deactivations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dan-and-negative-correlations">DAN and negative correlations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#connectomes-et-networks">Connectomes et networks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brain-networks-atlases">Brain networks atlases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus">Bonus</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Pierre Bellec et l'équipe PSY3018
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>